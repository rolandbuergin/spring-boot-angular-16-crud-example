<div *ngIf="isAuthenticated; else loginForm">
  <div class="glass-card p-4 p-md-5 mb-3">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <p class="text-uppercase text-muted small mb-1">Administration</p>
        <h3 class="mb-0">Alle Städte verwalten</h3>
      </div>
      <button class="btn btn-outline-secondary btn-sm" (click)="logout()">Logout</button>
    </div>

    <div *ngIf="loadError" class="alert alert-danger" role="alert">
      {{ loadError }}
    </div>

    <div *ngIf="loading" class="alert alert-info" role="alert">Lade Einträge...</div>

    <div *ngIf="!loading && tutorials.length > 0; else noEntries">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead>
            <tr>
              <th scope="col">Name</th>
              <th scope="col">Beschreibung</th>
              <th scope="col">Einwohner</th>
              <th scope="col" class="text-end">Aktionen</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let tutorial of tutorials">
              <td class="fw-semibold">{{ tutorial.title }}</td>
              <td class="text-muted">{{ tutorial.description }}</td>
              <td>{{ tutorial.einwohner | number }}</td>
              <td class="text-end">
                <button
                  class="btn btn-sm btn-outline-danger"
                  (click)="deleteTutorial(tutorial.id)"
                >
                  Löschen
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<ng-template #loginForm>
  <div class="row justify-content-center">
    <div class="col-md-8 col-lg-6">
      <div class="glass-card p-4 p-md-5">
        <h3 class="mb-3">Admin-Login</h3>
        <form (ngSubmit)="login()" #adminForm="ngForm" novalidate>
          <div class="form-group mb-3">
            <label for="username">Benutzername</label>
            <input
              type="text"
              class="form-control"
              id="username"
              required
              name="username"
              [(ngModel)]="username"
              #usernameControl="ngModel"
            />
            <div
              *ngIf="usernameControl.invalid && (usernameControl.dirty || usernameControl.touched)"
              class="text-danger small"
            >
              Benutzername ist erforderlich.
            </div>
          </div>

          <div class="form-group mb-4">
            <label for="password">Passwort</label>
            <input
              type="password"
              class="form-control"
              id="password"
              required
              name="password"
              [(ngModel)]="password"
              #passwordControl="ngModel"
            />
            <div
              *ngIf="passwordControl.invalid && (passwordControl.dirty || passwordControl.touched)"
              class="text-danger small"
            >
              Passwort ist erforderlich.
            </div>
          </div>

          <button type="submit" class="btn btn-accent w-100" [disabled]="adminForm.invalid">
            Anmelden
          </button>
        </form>

        <div *ngIf="loginError" class="alert alert-danger mt-3" role="alert">
          {{ loginError }}
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #noEntries>
  <div class="alert alert-info" role="alert">Keine Einträge gefunden.</div>
</ng-template>
