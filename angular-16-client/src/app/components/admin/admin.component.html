<div class="admin-shell glass-card p-4">
  <div *ngIf="isAuthenticated; else loginForm">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <div>
        <div class="section-heading">
          <span class="dot"></span>
          <span class="text-uppercase text-muted fw-semibold">Admin</span>
        </div>
        <h3 class="mb-0">Einträge verwalten</h3>
      </div>
      <button class="btn btn-outline-secondary btn-sm" (click)="logout()">Logout</button>
    </div>

    <div *ngIf="loadError" class="alert alert-danger" role="alert">
      {{ loadError }}
    </div>

    <div *ngIf="loading" class="alert alert-info alert-soft" role="alert">Lade Einträge...</div>

    <div *ngIf="!loading && tutorials.length > 0; else noEntries">
      <div class="table-responsive glass-card p-3">
        <table class="table table-modern align-middle mb-0">
          <thead>
            <tr>
              <th scope="col">Name</th>
              <th scope="col">Beschreibung</th>
              <th scope="col">Einwohner</th>
              <th scope="col" class="text-end">Aktionen</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let tutorial of tutorials">
              <td class="fw-semibold">{{ tutorial.title }}</td>
              <td>{{ tutorial.description }}</td>
              <td>{{ tutorial.einwohner }}</td>
              <td class="text-end">
                <button
                  class="btn btn-sm btn-outline-danger"
                  (click)="deleteTutorial(tutorial.id)"
                >
                  Löschen
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<ng-template #loginForm>
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="glass-card p-4">
        <div class="section-heading">
          <span class="dot"></span>
          <span class="text-uppercase text-muted fw-semibold">Admin-Login</span>
        </div>
        <h3 class="mb-3">Sicher anmelden</h3>
        <form (ngSubmit)="login()" #adminForm="ngForm" novalidate>
          <div class="form-group mb-3">
            <label for="username">Benutzername</label>
            <input
              type="text"
              class="form-control input-elevated"
              id="username"
              required
              name="username"
              [(ngModel)]="username"
              #usernameControl="ngModel"
            />
            <div
              *ngIf="usernameControl.invalid && (usernameControl.dirty || usernameControl.touched)"
              class="text-danger small"
            >
              Benutzername ist erforderlich.
            </div>
          </div>

          <div class="form-group mb-4">
            <label for="password">Passwort</label>
            <input
              type="password"
              class="form-control input-elevated"
              id="password"
              required
              name="password"
              [(ngModel)]="password"
              #passwordControl="ngModel"
            />
            <div
              *ngIf="passwordControl.invalid && (passwordControl.dirty || passwordControl.touched)"
              class="text-danger small"
            >
              Passwort ist erforderlich.
            </div>
          </div>

          <button type="submit" class="btn btn-brand" [disabled]="adminForm.invalid">
            Anmelden
          </button>
        </form>

        <div *ngIf="loginError" class="alert alert-danger mt-3" role="alert">
          {{ loginError }}
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #noEntries>
  <div class="alert alert-info alert-soft" role="alert">Keine Einträge gefunden.</div>
</ng-template>
